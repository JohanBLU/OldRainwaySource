version=pmwiki-2.2.118 ordered=1 urlencoded=1
author=MFWolff
charset=UTF-8
csum=$UploadNameChars
name=PmWikiDe.UploadVariables
rev=18
targets=PmWikiDe.UploadsAdmin,PmWikiDe.UploadVariables,Cookbook.Attachtable,PmWikiDe.PathVariables,PmWikiDe.LinkVariables,PmWikiDe.AvailableActions,PmWikiDe.BasicVariables
text=(:title Variablen für das Hochladen:)%0a(:Summary: Variablen für das Hochladen:)%0a(:Original_Page: PmWiki.{$Name}:)%0a(:Translation_Date: 2005-09-21:)%0a(:Translation_Status: %25green%25fertig%25%25:)%0a(:Audience: Administratoren (Fortgeschritten):)%0a%0a:$EnableUpload:Das Skript upload.php wird automatisch von stdconfig.php eingebunden, wenn die Variable $EnableUpload wahr (true) in config.php gesetzt wurde. Es kann sein, dass immer noch ein Hochladen-Passwort gesetzt werden muss, bevor das Hochladen möglich ist (siehe [[Uploads admin|Administration hochgeladener Dateien]]).%0a%0a:$UploadBlacklist:Dieses Array enthält verbotene Zeichenketten für hochzuladene Dateien (Groß/Kleinschreibung egal). \%0aEinige Installationen mit Apache-Servern versuchen eine Datei, deren Name ".php", ".pl" oder ".cgi" enthält, auszuführen, selbst wenn diese Erweiterung nicht der letzte Teil des Namen ist. Zum Beispiel wird eine Datei "test.php.txt" womöglich ausgeführt. Um das Hochladen solcher Dateien zu verhindern, fügen Sie zur Datei ''config.php'' eine solche Zeile hinzu:%0a: : [@$UploadBlacklist = array('.php', '.pl', '.cgi', '.py'); # Skriptdateien hochzuladen verbieten@]%0a%0a:$UploadPermAdd:Diese Variable setzt zusätzliche Unix-Rechte, die für neu hochgeladene Dateien angewendet werden, und sollte 0 sein (empfohlen seit 2013). Wenn hochgeladene Dateien nicht heruntergeladen werden können, und auf der Webseite wird z.&nbsp;B. der Fehler 403 Forbidden angezeigt, setzen Sie diesen Wert auf 0444 (interne Setzung, Vorgabe seit 2004).%0a: : [@$UploadPermAdd = 0; # empfohlen@]%0a%0a:$UploadPermSet:Diese Variable setzt Unix-Rechte, die bedingungslos für neu hochgeladene Dateien gesetzt werden, z.&nbsp;B.  @@0604@@. %25note%25'''Gefahr!''' Verändern Sie diese Variable nicht, es sei denn, Sie wissen was Sie tun! %25%25Wenn Sie einen Fehler machen, könnten es unmöglich werden, hochgeladene Dateien mittels FTP/SSH-Zugang zu verändern oder zu löschen (in dem Falle könnte Cookbook:Attachtable angewendet werden) oder herunterzuladen und in der Website anzuzeigen. Beachten Sie, dass Datei-Rechte auf verschiedenen Systemen unterschiedlich sein können - wenn Sie Ihre PmWiki-Installation kopieren oder verschieben, müssten Sie sie eventuell anpassen.%0a %0a:$UploadDir:Das Verzeichnis, in dem hochgeladene Dateien gespeichert werden. Standard ist  ''uploads/'' im pmwiki Verzeichnis, kann aber auf jedes Verzeichnis auf dem Server gesetzt werden. Dieses Verzeichnis muss vom Webserver beschreibbar sein, wenn ein Hochladen erfolgt.%0a%0a:$UploadUrlFmt: Die Internetadresse des Verzeichnisses, das durch $UploadDir bestimmt wird. Standard ist, die Adresse aus $PubDirUrl und $UploadDir abzuleiten.  %0a%0a[[#IMapLinkFmtAttach]]%0a:$IMapLinkFmt[=['Attach:']=]: Das Format, in dem der Hochladen-Verweis angezeigt wird, wenn ein Anhang existiert. Es kann durch eine solche Zeile in der ''config.php''-Datei geändert werden:[@%0a$IMapLinkFmt['Attach:'] = "%3ca class='attachlink' href='\$LinkUrl'>\$LinkText%3c/a>";@]%0a    %0a:$LinkUploadCreateFmt: Das Format des Hochladen-Verweises, wenn kein Anhang vorhanden ist. Es kann durch eine solche Zeile in der ''config.php''-Datei geändert werden:[@%0a$LinkUploadCreateFmt = "%3ca class='createlinktext' href='\$LinkUpload'>\$LinkText%3c/a>%0a%3ca class='createlink' href='\$LinkUpload'>&nbsp;&Delta;%3c/a>";@]%0a%0a:$UploadPrefixFmt: Setzt den Präfix für hochgeladenen Dateien. Damit können Anhänge anstatt nach Gruppen auf eine andere Weise organisiert werden. Standard ist [@'/$Group'@] (hochgeladene Dateien werden nach den Gruppen organisiert), kann aber auch für die gesamte Webseite oder für eine seitenweise Organisation gesetzt werden.%0a    $UploadPrefixFmt = '/$Group/$Name'; # Anhänge nach Seiten organisiert%0a    $UploadPrefixFmt = '';              # Anhänge der gesamten Website in einem gemeinsamen Verzeichnis%0a%0a: :Es wird empfohlen, die $UploadPrefixFmt-Variable in der ''config.php''-Datei so zu definieren, dass das Verzeichnis für die Dateien aller Seiten gilt und nicht gruppen- oder seitenweise organisiert wird. Andernfalls können Sie nicht auf Anhänge anderer Seiten oder Gruppen verweisen. %0a%0a:$EnableDirectDownload: Wenn diese Variable auf 1 gesetzt wird (Standard), umgehen die Verweise PmWiki und kommen direkt vom Webserver. Wird $EnableDirectDownload=0; eingestellt, wird jede Anfrage nach einem Anhang von [[PmWikiDe/AvailableActions#download|[@?action=download@]]] behandelt. Damit ist es für PmWiki möglich, Anhänge gemäß den Leserechten der Seite zu schützen. Allerdings erhöht das auch die Belastung des Servers. Vergessen Sie nicht, das Hochladen-Verzeichnis mit einer ''.htaccess''-Datei zu schützen (Order Deny,Allow / Deny from all).%0a%0a:$EnableUploadGroupAuth:Setzen Sie @@$EnableUploadGroupAuth = 1;@@, um Herunterladen mit dem Gruppen-Passwort authentifizieren zu können. Das kann zusammen mit @@$EnableDirectDownload = 0;@@ genutzt werden.\\%0a %25note%25Beachten Sie: $EnableUploadGroupAuth sollte nicht aktiviert werden, wenn Ihr Wiki die Anhänge seitenweise organisiert.%0a%0a:$EnableUploadVersions:Wenn diese Variable auf 1 (Standard ist 0) gesetzt wird, wird eine bestehende Datei gleichen Namens zu @@datei.erw,zeitpunkt@@ umbenannt, wenn hochgeladen wird (anstatt sie zu überschreiben). @@zeitpunkt@@ ist eine Zeitangabe im Unix-Stil.%0a%0a:$EnableUploadOverwrite:Wird auf 1 gesetzt, wenn früher hochgeladene Dateien (gleichen Namens) überschrieben werden dürfen.%0a%0a:$UploadNameChars:Der Satz der Zeichen, die in den Namen hochgeladener Dateien vorkommen dürfen. Voreingestellt ist [@"-\w. "@], das bedeutet Bindestriche, alphanumerische Zeichen und Unterstriche, Punkte und Leerzeichen dürfen in den Namen benutzt werden, alles andere wird herausgestrichen. Man kann nur Zeichen zulassen, die in der 'code page' (der Zeichensatztabelle) des Wikis vorkommen, siehe [[https://de.wikipedia.org/wiki/Zeichensatztabelle|Wikipedia:Zeichensatztabelle]].%0a: :$UploadNameChars = "-\\w. !";    # erlaube Bindestriche, Buchstaben, Ziffern, Unterstriche, Punkte, Leerzeichen und Ausrufezeichen%0a: :$UploadNameChars = "-\\w. \\x80-\\xff"; # erlaube Unicode%0a: : Beachte: Nicht alle Zeichen können in Dateinamen verwendet werden, wegen verschiedener Einschränkungen durch Protokolle oder Betriebssystemen, Dateisystemen und Serversoftware oder Konflikte mit PmWiki-Auszeichnungen. %0a** [@ +?:@#%25!=/ @] haben besondere Bedeutungen in URL-Adressen,%0a** [@ |\^`[]?:@#%25/ @] könnten auf einigen Systemen unmöglich zu speichern sein,%0a** [@ %3c>"|\^`(){}[]#%25 @] könnten mit PmWiki-Auszeichnungen kollidieren,%0a: : es wird also ausdrücklich empfohlen, diese nur dann zu erlauben, wenn Sie wissen, was Sie tun.%0a%0a:$MakeUploadNamePatterns: ein Array von Ersetzungen mittels regulärer Ausdrücke, mit deren Hilfe die Dateinamen der hochgeladenen Dateien normalisiert werden. Zuerst wird alles außer $UploadNameChars heraus gestrichen, dann wird die Dateierweiterung in Kleinbuchstaben umgewandelt. Administratoren können diese Ersetzungen mit eigenen Definitionen überschreiben (das ganze Array muss neu definiert werden). Aktuell wird die folgende Sequenz abgearbeitet:[@%0a    $MakeUploadNamePatterns = array(%0a    "/[^$UploadNameChars]/" => '',   # streiche alle nicht erlaubten Zeichen%0a    '/\\.[^.]*$/' => 'cb_tolower',   # wandle die Dateierweiterung in Kleinbuchstaben um (callback-Funktion)%0a    '/^[^[:alnum:]_]+/' => '',       # streiche führende Leerzeichen, Bindestriche und Punkte%0a    '/[^[:alnum:]_]+$/' => ''));     # streiche Leerzeichen, Bindestriche und Punkte am Ende%0a@]%0a%0a%0a:$UploadDirQuota:Generelle Größenbegrenzung für hochzuladende Dateien.%0a%0a->[@%0a   $UploadDirQuota = 100*1024;         # begrenzt Uploads auf  100KiB%0a   $UploadDirQuota = 1000*1024;        # begrenzt Uploads auf 1000KiB%0a   $UploadDirQuota = 1024*1024;        # begrenzt Uploads auf    1MiB%0a   $UploadDirQuota = 25*1024*1024;     # begrenzt Uploads auf   25MiB%0a   $UploadDirQuota = 2*1024*1024*1024; # begrenzt Uploads auf    2GiB%0a@]%0a%0a:$UploadPrefixQuota:Generelle Größenbegrenzung für ein Verzeichnis mit hochzuladende Dateien. Dies Verzeichnis ist gewöhnlich @@uploads/GroupName@@ (eines für jede Wiki-Gruppe) oder @@uploads/Group/PageName@@ (eines für jeder Seite), abhängig von der Variablen $UploadPrefixFmt.%0a%0a:$UploadMaxSize:Maximale Größe von hochzuladenden Dateien, voreingestellt sind 50000 Bytes.%0a%0a:$UploadExtSize:Maximale Größe je Dateierweiterung, überschreibt den Wert in $UploadMaxSize.%0a%0a->[@%0a   $UploadExtSize['zip'] = 2*1024*1024; # Erlaube ZIP-Dateien bis zu 2MiB%0a@]%0a%0a:$UploadRedirectFunction:Die Funktion, die aufgerufen werden muss, nachdem eine Datei hochgeladen wurde. Gewöhnlich wird die Funktion mit den Argumenten $pagename und dem URL der ?action=upload-Seite aufgerufen (mit zusätzlichen Informationen, ob das Hochladen erfolgreich war oder warum es das nicht war und ob die Datei umbenannt wurde). Ein Add-On darf seine eigene Funktion definieren, z.&nbsp;B. würde ein AJAX-Funktion zum Hochladen nur Variablen an den Browser zurückgeben.%0a%0a%0a
time=1567510635
title=Variablen für das Hochladen
